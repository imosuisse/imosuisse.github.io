Find all functions $f\colon \mathbb{R} \to \mathbb{R}$ such that for all $x,y\in\mathbb{R}$:
$$(f(x)+y)(f(x-y)+1)= f(f(xf(x+1)) - yf(y-1)).$$
