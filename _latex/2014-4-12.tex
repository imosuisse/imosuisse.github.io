Let $n$ be a positive integer and $a_1,a_2, \dots,a_n$ also be positive integers.
We periodically extend the sequence such that $a_{n+i} = a_i$ for all $i\geq 1$.
Assume that the following two conditions hold:
\begin{itemize}
    \item $a_1\leq a_2\leq\cdots \leq a_n\leq a_1 +n$.
    \item $a_{a_i} \leq n+i-1$ for $i=1,2\dots,n$.
\end{itemize}
Show that:
\[
    a_1+a_2+dots +a_n \leq n^2
\]
